BAPP=4
ID=HPSDR
Name=HPSDR
Comment='Raspberry Pi 3/4 standalone code for HPSDR'
VerLocal=0
VerRemote=0
W3='https://github.com/g0orx/pihpsdr/wiki/Compiling-piHPSDR-on-Raspberry-Pi-running-Raspberry-Pi-OS'
Author='spud'
NOTE='hpsdr for pi3/4, see the wiki for more info'

INSTALL(){
    echo -e "INFORMATIONAL: apt-get required packages"
    sudo apt-get -y install libsoapysdr-dev
    sudo apt-get -y install libgpiod-dev 
    sudo apt-get -y install libgtk-3-dev 
    sudo apt-get -y install libi2c-dev

    cd ${BAPSRC}
    sudo rm -rf pihpsdr-src
    mkdir pihpsdr-src
    cd pihpsdr-src

    git clone https://github.com/g0orx/pihpsdr.git

    echo -e "INFORMATIONAL: WDSP is a dependency for pihpsdr.  It will be installed now."    
    git clone https://github.com/g0orx/wdsp.git
    cd wdsp
    make clean
    make -j4
    sudo make install
    cp libwdsp.so ../pihpsdr/release/pihpsdr

    echo -e "INFORMATIONAL: Building pihpsdr.  This will take a while."
    cd ../pihpsdr

    # enable soapysdr support
    echo -e "INFORMATIONAL: Enabling soapysdr support"
    sed -i 's/#SOAPYSDR_INCLUDE=SOAPYSDR/SOAPYSDR_INCLUDE=SOAPYSDR/g' Makefile

    make clean
    make -j4
    make release

    tar xvf release/pihpsdr.tar -C ~/
    sh ~/pihpsdr/install.sh

}

VERSION(){
    if [[ -d "~/pihpsdr" ]];then
        CURRENT=0-git
    else
        CURRENT=NONE
    fi
    NEWVER=0-git
}

DEPENDS(){
    NEEDED=''
    #apt-gets will be checked on app-check
}
